<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注册页面</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/register.css">
    <script>
        function reg() {
            //http://127.0.0.1:8080/register.html
            var _uname = uname.value;
            var _upwd = upwd.value;
            var _cpwd = cpwd.value;
            var usernameRule = /^(\w|[\u4e00-\u9fa5]){3,12}$/;
            var passwordRule = /^[a-zA-Z0-9]{6,16}$/;
            if (!usernameRule.test(_uname)) {
                alert("用户名必须是3~12位的数字、字母、下划线或汉字");
                //c1.innerHTML="格式错误";
                return;
            }
            if (!passwordRule.test(_upwd)) {
                alert("密码必须是6~16的数字、字母");
                return;
            }
            if (!_uname) {
                alert("用户名不能为空");
                return;
            }
            if (!_upwd) {
                alert("密码不能为空");
                return;
            }
            
            if (_cpwd != _upwd) {
                alert('密码不一致');
            }
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var r = xhr.responseText;
                    if (r == '{"success":true}') {
                        alert("注册成功");
                        d1.innerHTML = "注册成功";
                        location.href = "login.html";

                    }
                    else {
                        d1.innerHTML = "注册失败";
                    }

                }
            }
            xhr.open("post", "/pro/v1/register", true);
            var formdata = `uname=${_uname}&upwd=${_upwd}`;
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.send(formdata);
        }

    </script>

</head>

<body>
    <div class="w">
        <div class="header">
            <div class="logo">
                <a href="index.html"> <img src="../img/logo.png" alt=""></a>
            </div>
        </div>
        <div class="register_area">
            <h3>
                注册新用户
                <em>我有账号，去<a href="login.html">登录</a></em>
            </h3>
            <div class="reg_form">
                <form action="">
                    <ul>
                        <li>
                            <label for="tel">用户名：</label>
                            <input type="text" name="" id="uname" class="inp">
                            <span class="error" id='c1'>
                                <i class="error_icon"></i>
                                </span>
                        </li>
                        <li>
                            <label for="">登录密码：</label>
                            <input type="text" name="" id="upwd" class="inp">
                            <span class="success">
                                <i class="success_icon"></i>
                                恭喜您，输入正确</span>
                        </li>
                        <li class="safe">
                            安全程度
                            <em class="ruo">弱</em>
                            <em class="zhong">中</em>
                            <em class="qiang">强</em>

                        </li>
                        <li>
                            <label for="">确认密码：</label>
                            <input type="text" name="" id="cpwd" class="inp">
                            <span class="success">
                                <i class="success_icon"></i>
                                恭喜您，输入正确</span>
                        </li>
                        <li class="agree">
                            <input type="checkbox" name="" id="" checked>
                            同意协议并注册
                            <a href="#">《用户协议》</a>
                        </li>
                    </ul>

                    <button class="over" onclick="reg()">完成注册
                    </button>

                    <div id="d1"></div>

                </form>
            </div>
        </div>
        <div class="footer">
            <div class="mod_copyright">
                <p class="mod_copyright_links">
                    关于我们 | 联系我们 | 关于我们 | 商家入驻 | 营销中心 | 友情链接 | 关于我们 | 营销中心 | 友情链接 | 关于我们
                </p>
                <p class="mod_copyright_info">
                    地址：北京市昌平区建材城西路金燕龙办公楼一层 邮编：100096 电话：400-618-4000 传真：010-82935100</br>
                    京ICP备08001421号京公网安备110108007702
                </p>
            </div>
        </div>
    </div>
</body>

</html>